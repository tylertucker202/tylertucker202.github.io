<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Python Time Series Fit &mdash; itsonlyamodel</title>
  <meta name="author" content="tyler tucker">






  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="./favicon.png" rel="icon">

  <link href="./theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="./">itsonlyamodel</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
      <li >
        <a href="./category/about.html">About</a>
      </li>
      <li class="active">
        <a href="./category/argo.html">Argo</a>
      </li>
      <li >
        <a href="./category/ims.html">Ims</a>
      </li>
      <li >
        <a href="./category/math.html">Math</a>
      </li>
      <li >
        <a href="./category/python.html">Python</a>
      </li>
      <li >
        <a href="./category/statistics.html">Statistics</a>
      </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Python Time Series Fit</h1>
    <p class="meta">
<time datetime="2017-12-28T23:00:00-08:00" pubdate>Thu 28 December 2017</time>    </p>
</header>

  <div class="entry-content"><style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Nonlinear-Least-squares-fitting-time-series-in-Python">Nonlinear Least squares fitting time series in Python<a class="anchor-link" href="#Nonlinear-Least-squares-fitting-time-series-in-Python">¶</a></h1><p>This post is the third part of a three-part series into argovis.</p>
<ol>
<li><a href="http://www.itsonlyamodel.us/argovis-python-api.html">Argovis api</a> introduces my website <a href="http://www.argovis.com">www.argovis.com</a>, and how users can access data using a python API. </li>
<li><a href="http://www.argo.ucsd.edu/r-time-series-fit.html">Linear time series analysis in R</a> shows how time series models can be used to fit ocean temperatures from Argo data.</li>
<li><a href="http://www.argo.ucsd.edu/python-time-series-fit.html">Linear time series model fitting in python</a> gives further detail on how non-linear least squares fitting is typically done on time series. </li>
</ol>
<p>As we saw in the previous notebook, R has an arima() function that can perfrom fits on our time series generated from Argo floats around Gilbralter. The seasonal trend was removed, leaving us with a stationary model. I decided to keep the two models AR(1) and AR(4), and compare them with our own parameter finding algorithm in python. I also will compare our method with scipy's own minimization algorithms.</p>
<p>I know of three methods to estimate times series parameters: method of moments, exact liklihood, or conditional, or unconditional liklihood methods.</p>
<p>Method of moments is not very accurate, and is usually used as an initial guess to the more rigerous methods. The closed form of the exact liklihood is complicated. I didn't want to get lost in the details, as the scope of this notebook is to optimize an objective function. I decided to go with the unconditional sums of squares using the backcasting method.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Unconditional-liklihood-estimation-for-ARMA(p,q)-processes.">Unconditional liklihood estimation for ARMA(p,q) processes.<a class="anchor-link" href="#Unconditional-liklihood-estimation-for-ARMA(p,q)-processes.">¶</a></h2><p>Consider a time series modeled by an ARMA(p,q) process</p>
<p>$$
\phi_p(B)Z_t = \theta_q a_t
$$</p>
<p>It turns the conditional expectation $a_t$ maximum liklihood extimation is better estimate for $\hat{\phi_p}$, $\hat{\theta_p}$.</p>
<p>Estimated parameters are found maximizing the likelihood function by solving the conditional expectation of a_t, given some time series Z, mean $\mu$ and weights $\phi_p$, $\theta_p$.</p>
<p>$$arg\ max\ E(a_t| Z, \phi_p, \theta_q, \mu) = E\left(\frac{\phi_p(B)}{\theta_q(B)}\right)Z_t$$</p>
<p>Shocks a_t are assumed independently distributed white noise process.</p>
<p>$$E(a_t| Z, \phi_p, \theta_q, \mu) \sim WN(0, \sigma_a^2)$$</p>
<p>This sort of problem is solved using the conditional sum of squares of its log-likelihood function.</p>
<p>If we skip some details, the log-likelihood function is maximized by <strong>minimizing</strong> the function below.</p>
<p>$$f(\phi, \theta, \mu) = \frac{1}{2}\Sigma^n_{t=1} E(a_t|Z, \phi, \theta, \mu)^2$$.</p>
<p>One challange with time series is estimating the inital conditions. IE, what is $Z_0, Z_{-1}...etc?$ One simple way would be estimate inital conditions.
$$a_t = E(a_t) = 0$$
$$Z_t = E(Z_t) = \bar{Z_t}$$</p>
<p>At this point, I should note that we aren't solving variance $\sigma_a^2$. It is found after solving for $\hat{\phi}, \hat{\mu}, \hat{\theta}$.</p>
<p>Variance estimate $$\hat{\sigma}^2_a = \frac{f(\hat{\phi}, \hat{\mu}, \hat{\theta})}{df}$$</p>
<p>The degree of freedom</p>
<p>$$
df = n - 2p + q + 1
$$</p>
<p>For example, we can define an AR(1) model conditional likelihood as</p>
<p>$$
a_t = Z_t - \mu - \phi(Z_{t-1} - \mu) = Z_t - \mu - \phi Z_{t-1} - \phi \mu
$$</p>
<p>The model is non-linear, due to the term $\phi\mu$. One way to deal with the missing value $Z_{t-1}$ is to estimate is to replace it with the expected value given a series Z,</p>
<p>$$Z_{t-1} \sim E(Z_{t-1}|Z)$$</p>
<p>We write the method for retrieving shocks with the python method shock_AR1, before importing the libraries used by this notebook.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">spla</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numdifftools</span> <span class="k">as</span> <span class="nn">nd</span>
<span class="kn">import</span> <span class="nn">cmocean</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'docs/argo/desGilT.csv'</span><span class="p">)[</span><span class="s1">'ts'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(401,)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">shock_AR1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
    <span class="c1">#a[0] = np.mean(z)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">tdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">tdx</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">phi</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">tdx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>
<span class="n">AR1Shocks</span> <span class="o">=</span> <span class="n">shock_AR1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">AR1Shocks</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(401,)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Backcasting-method-for-unconditional-likelihood-estimation">Backcasting method for unconditional likelihood estimation<a class="anchor-link" href="#Backcasting-method-for-unconditional-likelihood-estimation">¶</a></h2><p>A better to estimate to the initial values is to use the backcasting method, previous shock values are estimeated until $z_{t} - z_{t-1} < .005$ for some value $t = 0, -1, ..., M$, where $M \geq -(t+1)$. Then you are able to create a backcasted shock values $a \in Real^{s}, s = n + M$ where n is the original length of the time series $Z_t$.</p>
<p>For example, the following time series of length 401 returns a length of 406 when backcasted as an AR(1) process.</p>
<p>Backcasting is performed once before the start our minimization algorithm. Non-stationary time series may cause the backcasting algorithm to go on indefinitely. Since our optimization framework doesn't account for stationarity constraints, we should avoid backcasting when optimizing.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">shock_backcasting_AR1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">zdot</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">-</span><span class="n">mu</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]</span>
    <span class="n">tb</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">zBack</span> <span class="o">=</span> <span class="n">zdot</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">zBack</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">zBack</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">>=</span> <span class="o">.</span><span class="mi">005</span><span class="p">):</span>
        <span class="n">zBack</span> <span class="o">=</span> <span class="p">[</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">zBack</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">zBack</span>
        <span class="n">tb</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">M</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">tb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">zdot</span> <span class="o">=</span> <span class="n">zBack</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">zdot</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zdot</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">tdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">zdot</span><span class="p">)):</span>
        <span class="n">shock</span><span class="p">[</span><span class="n">tdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">zdot</span><span class="p">[</span><span class="n">tdx</span><span class="p">]</span> <span class="o">-</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">zdot</span><span class="p">[</span><span class="n">tdx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">zBC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zdot</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shock</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">zBC</span>

<span class="n">bcAR1</span><span class="p">,</span> <span class="n">zBC</span> <span class="o">=</span> <span class="n">shock_backcasting_AR1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bcAR1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zBC</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>408
409
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From a numerical optimization stand point, the shocks $a_t$ can be written as residuals $r_t(x)$. Where x are the model parameters $[\phi, \mu,...]$ et cetra. For an objective function</p>
<p>$$
f(x) = \Sigma^n_{t=1} E(a|Z, \phi, \mu)^2 = \frac{1}{2}\Sigma^n_{t=1} r_t(x)^2
$$</p>
<p>where $ x = [\phi, \mu]$. If we treat $r_t(x)$ as a vector (r_1(x), r_2(x)...r_n(x)), then its derivitaves are described via the hessian</p>
<p>$$
J_{ti}(x) = \left[ \frac{\partial r_t(x)}{\partial x_i}\right]
$$</p>
<p>For an AR(1) model, shocks $a_t$ are considered the residual $r(x)$</p>
<p>$$
a_t = Z_t - \mu - \phi_1(Z_{t-1} - \mu) = r(x)
$$</p>
<p>There are two unknown parameters $\phi$ and $\mu$ thus $J_{ti}(x) \in R^{nx2}$.</p>
<p>$$J_{it}(x) = 
\begin{bmatrix}
    \frac{\partial r_t}{\partial \phi}, \frac{\partial r_t}{\partial \mu}
\end{bmatrix} = 
\begin{bmatrix}
    -Z_{t-1} + \mu ,-1 + \phi
\end{bmatrix}
$$</p>
<p>One important feature of this Jacobian is that the backcasted entries should be set to zero. Thus the first row of the AR(1) Jacobian are zeros.</p>
<p>$$J_{i0}(x) = 
\begin{bmatrix}
    \frac{\partial r_0}{\partial \phi} = 0, \frac{\partial r_0}{\partial \mu} = 0
\end{bmatrix}
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">JacAr1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">z1</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dPhi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">z1</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="n">dMu</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z1</span><span class="p">))</span>
    
    <span class="c1"># Jacobian is zero at t=0</span>
    <span class="n">dPhi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dMu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dPhi</span><span class="p">,</span> <span class="n">dMu</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="n">Jac0</span> <span class="o">=</span> <span class="n">JacAr1</span><span class="p">(</span><span class="n">zBC</span><span class="p">,</span> <span class="n">phi</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">Jac0</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(408, 2)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check if our Jacobian is correct by comparing it with the python library numdifftools numerical approximation of the Jacobian.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myFun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">shock_AR1</span><span class="p">(</span><span class="n">zBC</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">JacApprox</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Jacobian</span><span class="p">(</span><span class="n">myFun</span><span class="p">)</span>

<span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">JacAr1</span><span class="p">(</span><span class="n">zBC</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="o">-</span> <span class="n">JacApprox</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>4.4305349724175143</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pretty good!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Minimizing-X">Minimizing X<a class="anchor-link" href="#Minimizing-X">¶</a></h2><p>Working with real data can make the Jacobian ill conditioned, making the Hessian approximation singular. The pure Newton Step may no longer work for determining p.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gauss-Newton-step">Gauss Newton step<a class="anchor-link" href="#Gauss-Newton-step">¶</a></h3><p>Working with real data can make the Jacobian ill conditioned, making the Hessian approximation singular. The pure Newton Step may no longer work for determining p. Anticipating a singular matrix, we introduce Gauss-Newton Step function GNP.</p>
<p>Gauss-Newton is a minimization procedure for finding a step length $p^{GN}$ for a linear system</p>
<p>$$
p^{GN} arg\ min_{p \in R^n} ||J(x_k)p + r(x_k)||^2
$$</p>
<p>Finding the optimal step length can be computationally expensive. Hence the simpler Cholesky decomposition is attempted first, followed by more reliable yet expensive methods.</p>
<p>This function relies on exception handling. If a singular matrix raises an error, the step length is found using QR decomposition. If QR decomposition fails, then the step length is found using an SVD approach.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">GNP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shockFun</span><span class="p">,</span> <span class="n">gradFun</span><span class="p">,</span> <span class="n">jacFun</span><span class="p">,</span> <span class="n">hessFun</span><span class="p">):</span>
    <span class="c1">#Cholsesky attempt</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">hessFun</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">lower</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">RTR</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">R</span><span class="p">))</span>
        <span class="n">pChol</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RTR</span><span class="p">,</span> <span class="n">gradFun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">pChol</span>
    <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># QR decomposition attempt</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">Q</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">jacFun</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">pivoting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'economic'</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">get_perm_matrix</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="n">negPinvR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">spla</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
        <span class="n">QTr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">jacFun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">pQR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">negPinvR</span><span class="p">,</span> <span class="n">QTr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="ow">in</span> <span class="n">pQR</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">return</span> <span class="n">pQR</span>
    <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># SVD attempt</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">VT</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">jacFun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">UTr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">shockFun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="n">pSVD</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">VT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">vTCol</span> <span class="o">=</span> <span class="n">VT</span><span class="p">[:,</span><span class="n">col</span><span class="p">]</span>
            <span class="n">sigCol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="n">UTr</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">/</span> <span class="n">sigCol</span>
            <span class="n">pSVD</span> <span class="o">+=</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">vTCol</span>
        <span class="k">return</span> <span class="n">pSVD</span>
    <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">'singular matrix'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'svd did not work.'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span>

<span class="k">def</span> <span class="nf">get_perm_matrix</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
        <span class="n">M</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[:,</span> <span class="n">col</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following helper functions are defined for an inital guess point x0.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_functions</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
    <span class="n">zBC</span> <span class="o">=</span> <span class="n">shock_backcasting_AR1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'length of z: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'length of backcasted z: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zBC</span><span class="p">)))</span>
    <span class="n">myFun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">shock_AR1</span><span class="p">(</span><span class="n">zBC</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">myJac</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">JacAr1</span><span class="p">(</span><span class="n">zBC</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">myGrad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myJac</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">myFun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">myHess</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myJac</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">myJac</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">myObj</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myFun</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">myFun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">pGN</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">GNP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">myFun</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myJac</span><span class="p">,</span> <span class="n">myHess</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">myFun</span><span class="p">,</span> <span class="n">myJac</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">pGN</span>

<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">myFun</span><span class="p">,</span> <span class="n">myJac</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">pGN</span> <span class="o">=</span> <span class="n">init_functions</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">pGN</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">J0</span> <span class="o">=</span> <span class="n">myJac</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">F0</span> <span class="o">=</span> <span class="n">myObj</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">g0</span> <span class="o">=</span> <span class="n">myGrad</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">H0</span> <span class="o">=</span> <span class="n">myHess</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>length of z: 401
length of backcasted z: 446
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualization-of-the-AR(1)-objective-function-sample-space">Visualization of the AR(1) objective function sample space<a class="anchor-link" href="#Visualization-of-the-AR(1)-objective-function-sample-space">¶</a></h3><p>It is helpfull to view the sample space of our objective function</p>
<p>$$
f(x) = \frac{1}{2}\Sigma^n_{t=1} r_t(x)^2
$$</p>
<p>around the point</p>
<p>$$
x^{arima}_{opt}Sol = [\phi = 0.8141, \mu = 19.4998]
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_contour_data</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
    <span class="n">x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
    <span class="n">x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
    <span class="n">XX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>
    <span class="n">XX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">XX</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">XX</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">ndim</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">xGrid</span> <span class="ow">in</span> <span class="n">XX</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">myObj</span><span class="p">(</span><span class="n">xGrid</span><span class="p">))</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">contourPlot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">figNum</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ice</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Contour of r(t)'</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\mu$'</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\phi$'</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ice</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="n">xArimaSol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8141</span><span class="p">,</span> <span class="mf">19.4998</span><span class="p">])</span>
<span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">get_contour_data</span><span class="p">(</span><span class="n">xArimaSol</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig0</span> <span class="o">=</span> <span class="n">contourPlot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The convexity of this countour plot is encouraging. We should be able to find a solution at the bottom of this blue basin.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">F0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>83.1650196822
(445, 2)
(2,)
(2, 2)
(2,)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Minimizing-AR(1)-fit-f(x)-using-a-Gauss-Newton-method">Minimizing AR(1) fit f(x) using a Gauss-Newton method<a class="anchor-link" href="#Minimizing-AR(1)-fit-f(x)-using-a-Gauss-Newton-method">¶</a></h1><p><strong>Numerical Optimzation</strong> by Nocedal and Wright suggest using a Gauss-Newton line search method for non-linear least square fitting. For the Gauss-Newton step, I am computing the inverse of the approximate Hessian. As long as the Hessian isn't singular, this step is valid.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">myGaussNewton</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">objFun</span><span class="p">,</span> <span class="n">gradFun</span><span class="p">,</span> <span class="n">hessFun</span><span class="p">,</span> <span class="n">dirFun</span><span class="p">,</span> <span class="n">timeIt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="mi">8</span><span class="p">,</span> <span class="n">dprint</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
    <span class="n">gradF</span> <span class="o">=</span> <span class="n">gradFun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">normGrad</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gradF</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">hessFun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">xCurr</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">FOut</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">gradOut</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">phiOut</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">muOut</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">normGrad</span> <span class="o">></span> <span class="n">eps</span><span class="p">:</span>
        <span class="n">pDir</span> <span class="o">=</span> <span class="n">dirFun</span><span class="p">(</span><span class="n">xCurr</span><span class="p">)</span>
        <span class="n">xNext</span> <span class="o">=</span> <span class="n">xCurr</span> <span class="o">+</span> <span class="n">pDir</span>
        <span class="n">gradFNext</span> <span class="o">=</span> <span class="n">gradFun</span><span class="p">(</span><span class="n">xNext</span><span class="p">)</span>
        <span class="n">HNext</span> <span class="o">=</span> <span class="n">hessFun</span><span class="p">(</span><span class="n">xNext</span><span class="p">)</span>
        <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">%</span> <span class="n">dprint</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1">#pdb.set_trace()</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">objFun</span><span class="p">(</span><span class="n">xCurr</span><span class="p">)</span>
            <span class="n">gradNorm</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gradFNext</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'on </span><span class="si">{}</span><span class="s1">th step'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'fOut: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">gradNorm: </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">gradNorm</span><span class="p">))</span>

        <span class="c1">#update values</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">HNext</span>
        <span class="n">xCurr</span> <span class="o">=</span> <span class="n">xNext</span>
        <span class="n">gradF</span> <span class="o">=</span> <span class="n">gradFNext</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">normGrad</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gradF</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'should not have nan or inf in gradient'</span><span class="p">)</span>

        <span class="n">gradOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normGrad</span><span class="p">)</span>
        <span class="n">FOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objFun</span><span class="p">(</span><span class="n">xCurr</span><span class="p">))</span>
        <span class="n">phiOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xCurr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">muOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xCurr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">k</span> <span class="o">></span> <span class="mi">3000</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'not converging. exiting while loop'</span><span class="p">)</span>
            <span class="k">break</span>
        
    <span class="n">outDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'F'</span><span class="p">:</span> <span class="n">FOut</span><span class="p">,</span> <span class="s1">'normGrad'</span><span class="p">:</span> <span class="n">gradOut</span><span class="p">,</span> <span class="s1">'phi'</span><span class="p">:</span> <span class="n">phiOut</span><span class="p">,</span> <span class="s1">'mu'</span><span class="p">:</span> <span class="n">muOut</span><span class="p">}</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">objFun</span><span class="p">(</span><span class="n">xCurr</span><span class="p">)</span>
    <span class="n">gradNorm</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gradFNext</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">timeIt</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'algorithm has has terminated after </span><span class="si">{}</span><span class="s1"> steps'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'fOut: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">gradNorm: </span><span class="si">{1}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">gradNorm</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'xMin: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xCurr</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">xCurr</span><span class="p">,</span> <span class="n">outDict</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xGN</span><span class="p">,</span> <span class="n">GNDict</span> <span class="o">=</span> <span class="n">myGaussNewton</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>algorithm has has terminated after 2 steps
fOut: 21.936583099149388
gradNorm: 2.9754436402122983e-13
xMin: [  0.9645027   19.66902258]

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gauss-Newton model converges after 2 steps with a solution that overestimates arima fit...</p>
<p>Backcasting introduces estimated z values to the procedure, so based on the initial point $x_0$, the objective itself changes. If we vary the initial point, our solution changes.</p>
<p>Clearly we need to come up with an initial guess that best approximates the solution.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x0Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mi">30</span><span class="p">]])</span>

<span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">x0Array</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'initial coordinates for x0: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
    <span class="n">myFun</span><span class="p">,</span> <span class="n">myJac</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">pGN</span> <span class="o">=</span> <span class="n">init_functions</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">myGaussNewton</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>initial coordinates for x0: [ 0.1  0. ]
length of z: 401
length of backcasted z: 404
algorithm has has terminated after 2 steps
fOut: 134.74582946533877
gradNorm: 3.397907021896483e-11
xMin: [  0.76420615  19.51851071]

initial coordinates for x0: [  0.5  10. ]
length of z: 401
length of backcasted z: 410
algorithm has has terminated after 2 steps
fOut: 33.890500289415414
gradNorm: 6.878599883316829e-12
xMin: [  0.90668832  19.55928539]

initial coordinates for x0: [  0.99  30.  ]
length of z: 401
length of backcasted z: 709
algorithm has has terminated after 2 steps
fOut: 22.051923365729113
gradNorm: 1.9662055882241343e-12
xMin: [  0.99612495  19.395851  ]

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Estimating-starting-point-$x_0$-using-method-of-moments.">Estimating starting point $x_0$ using method of moments.<a class="anchor-link" href="#Estimating-starting-point-$x_0$-using-method-of-moments.">¶</a></h2><p>The time series model parameters depend on inital coordinates. Our initial guess can no longer be guess. Instead, we can estimate inital parameter $x_0$ using the method of moments.</p>
<p>Estimation for mean using methods of moments is $\hat{\mu}=\bar{Z}$</p>
<p>For $\phi_i$ we use the autocorrelation function estimate, $\hat{\rho}_k$.</p>
<p>$$
\hat{\rho}_k = \frac{ \Sigma^{n-k}_{t=1} (Z_t - \bar{Z}) (Z_{t+k} - \bar{Z})}{\Sigma^n_{t=1} (Z_t - \bar{Z})^2}, k = 1, 2, ..., p
$$</p>
<p>An AR(1) $\phi$ weight is by</p>
<p>$$
\hat{\phi} = \hat{\rho}_1
$$</p>
<p>The starting point is defined as</p>
<p>$$
x_0 = [\hat{\phi}, \hat{\mu}]
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_inital_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">meanZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="c1"># make vector Z_t - meanZ</span>
    <span class="n">lVect</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">:]</span><span class="o">-</span><span class="n">meanZ</span>
    <span class="c1"># make vector Z_{t-1} - meanZ</span>
    <span class="n">rVect</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">meanZ</span>
    <span class="n">auto_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lVect</span><span class="p">,</span> <span class="n">rVect</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">meanZ</span><span class="p">,</span><span class="n">z</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">meanZ</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">auto_cov</span><span class="p">,</span> <span class="n">meanZ</span><span class="p">])</span>

<span class="n">x0</span> <span class="o">=</span> <span class="n">get_inital_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'inital x0 estimate: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>inital x0 estimate: [  0.80372595  19.48976062]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A consistant initial guess based on the data eliminates the unwanted change in the objective function due to backcasting.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AR(1)-Model-performance">AR(1) Model performance<a class="anchor-link" href="#AR(1)-Model-performance">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">get_inital_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">myFun</span><span class="p">,</span> <span class="n">myJac</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">pGN</span> <span class="o">=</span> <span class="n">init_functions</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">xGN</span><span class="p">,</span> <span class="n">GNDict</span> <span class="o">=</span> <span class="n">myGaussNewton</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>length of z: 401
length of backcasted z: 415
algorithm has has terminated after 2 steps
fOut: 19.954174586982298
gradNorm: 1.0959762715111268e-14
xMin: [  0.81585758  19.49976398]

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GNDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">GNDict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GNDF</span><span class="p">[</span><span class="s1">'F'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.axes._subplots.axessubplot at 0x7fddca4c5b00></pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GNDF</span><span class="p">[</span><span class="s1">'normGrad'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.axes._subplots.axessubplot at 0x7fddca451240></pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYgAAAD8CAYAAABthzNFAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAIABJREFUeJzt3Xd4VGX6xvHvk4QQegtNQOlgkCIGpCcB1KAoFlSwoFgQ
URBI1lV31e26Gqoi2BV1VewoCAohCR2C0mtAEJAOIoKIkff3R8aVHxvIBJKcmcn9ua5czJnzvslz
3ivMnTkz5xlzziEiInKyMK8LEBGRwKSAEBGRXCkgREQkVwoIERHJlQJCRERypYAQEZFcKSBERCRX
CggREcmVAkJERHIV4XUB+REdHe3q1q3rdRkiIkFlyZIle51zVfM7L6gCom7dumRmZnpdhohIUDGz
LWcyT6eYREQkVwoIERHJlQJCRERypYAQEZFcKSBERCRXCggREcmVAkJERHIVVAHxw9Ff0EekiogU
jaAKiC37jnD7q4vZtOdHr0sREQl5QRUQNStE8dWWA1w2OoMnPl/Djz9ne12SiEjICqqAiC5bkpnJ
cfRqVYvn0zfRbUQanyzdrtNOIiKFIKgCAqBauShSrm/Jh4M6UL18FA+8s5Qbn1/A6u9+8Lo0EZGQ
EnQB8ZvW51bi40EdefLa5mTt+ZGez8zm0Y9X8v2RY16XJiISEoI2IADCwow+bc9lVlI8t7Y7j7cW
biEhJY23Fm7h1+M67SQicjaCOiB+U6F0Cf7a6wKmDOlMo+rl+NNHK+k1bg5LthzwujQRkaAVEgHx
m/NrlufdAe0Y2/dC9h46xnXj5zF80lJ2HzrqdWkiIkEnpAICwMy4quU5zEyKY1B8Az5btoOuKem8
mLGJX3497nV5IiJBI+QC4jdlSkbwYGJTpg/rQpu6lfjn1DUkjs5g9oY9XpcmIhIUQjYgflMvugyv
9m/Ly7fFkn3ccevLixj4xhK27j/idWkiIgEtqD6T+mx0O786HRtG8/Kcb3g2NYtZ63Zzb3wDBsY1
IKpEuNfliYgEHL+eQZhZopmtM7MsM3sol/1mZmN9+5ebWeu85ppZKzNbYGZLzSzTzNoWzCGdWlSJ
cO5LaMjMpDi6x1Rn9IwNdB+ZzrSVO3U1tojISfIMCDMLB8YBPYAYoK+ZxZw0rAfQyPc1ABjvx9yn
gL8651oBj/m2i8Q5FUsx7qbW/OfuiykTGcHAN5fQ75VFZO1WE0ARkd/48wyiLZDlnNvknDsGvAP0
OmlML2Ciy7EAqGhmNfOY64DyvtsVgO/O8ljyrUODaKYM6cTjV8awdOv3JI7O4J9TVnPo6C9FXYqI
SMDxJyBqAVtP2N7mu8+fMaebOxR42sy2AinAw/6XXXAiwsPo37Ees5Ljua51bV6a8w1dR6Tz4Vfb
dNpJRIo1L9/FdC8wzDlXBxgGvJzbIDMb4HuNInPPnsJ7i2p02ZL8u3cLPhrUkXMqRDF80jJ6T5jP
yu0HC+1niogEMn8CYjtQ54Tt2r77/Blzurm3AR/6br9Hzumo/+Gce8E5F+uci61ataof5Z6dVnUq
8tGgjjx1XQs27z3Mlc/O4ZGPVnDgsJoAikjx4k9ALAYamVk9M4sE+gCTTxozGejnezdTO+Cgc25H
HnO/A+J8t7sCG87yWApMWJhxQ5s6pCbHc3uHury7eCsJI9J4Y4GaAIpI8ZFnQDjnsoH7genAGmCS
c26VmQ00s4G+YVOBTUAW8CIw6HRzfXPuBkaY2TLgX+S8+ymgVChVgsevbMbUIZ05v0Z5Hv14JVc+
M4fFm/d7XZqISKGzYHohNjY21mVmZnrys51zTFmxg39OWcOOg0e5utU5PHz5+VQvH+VJPSIi/jKz
Jc652PzOC/lWGwXFzOjZIqcJ4P0JDZm6YiddU9KYkL6RY9lqAigioUcBkU+lIyNIvqwJXw7vQvsG
VXjy87Ukjs4gfb2aAIpIaFFAnKHzqpThpdva8Gr/NjjgtlcWcffETL7dpyaAIhIaFBBnKaFJNaYN
7cyDiU2Ym7WX7qPSGfnFOn469qvXpYmInBUFRAEoGRHOoPiGpCbFk9isBmNTs+g+Mp2pK3boamwR
CVoKiAJUo0IUY/teyLsD2lEuKoJBb33FLS8vZMOuQ16XJiKSbwqIQnBx/Sp8NrgTf+vVjBXbDtJj
zGz+/tlqflATQBEJIgqIQhIRHka/9nWZlRzP9bG1eWXuN3RNSee9zK0c19XYIhIEFBCFrErZkjxx
bQs+ua8jdSqX4g/vL+e6CfNYvu17r0sTETktBUQRaVG7Ih8M7EDK9S3Zuv8neo2by8MfLmffjz97
XZqISK4UEEUoLMzofVFtUpPjuLNjPd7L3EZCShqvz9tM9q+6GltEAosCwgPlo0rw554xfP5AZ5rX
rsDjk1fR85k5LNy0z+vSRET+SwHhoUbVy/HmnRcz/ubWHDqazY0vLGDw21+z4+BPXpcmIqKA8JqZ
0aN5TWYMj2NIt0ZMX7WTbiPSeS4ti5+zdTW2iHhHAREgSkWGM/ySxswcHkenhtE8NW0diaNnM2vt
bq9LE5FiSgERYOpULs0L/WJ5/Y62GND/tcXc+dpiNu897HVpIlLMKCACVFzjqkwb2oWHezRlwaZ9
XDoqg6enr+XIsWyvSxORYkIBEcAiI8K4J64BqcnxXNGiJuNmbaTbiHQ+XfadmgCKSKFTQASB6uWj
GHVjK94f2J5KpSMZ/PbX9H1xAet2qgmgiBQeBUQQia1bmU8Hd+IfV1/A2p2HuHzsbP4yeRUHf1IT
QBEpeAqIIBMeZtzS7jxmJcXTp00dXp+/ma4paby7+Fs1ARSRAqWACFKVykTyz2ua8+n9nagXXYY/
frCCa56by9KtagIoIgVDARHkLqhVgfcGtmfUjS357uBRrh43lwffX8ZeNQEUkbOkgAgBZsY1F9Ym
NSmOAV3q8+FX20lISeOVOd+oCaCInDEFRAgpF1WCRy4/n2lDu9CqTkX+9tlqLh87m3kb93pdmogE
IQVECGpYrSwT72jL87dexJFjv3LTiwu5762v2P69mgCKiP8UECHKzLisWQ1mDI9jWPfGzFizi24j
0ng2dQNHf1ETQBHJmwIixEWVCOeB7o2YmRRHQpNqpHyxnktHZTBj9S5djS0ip6WAKCZqVyrN+Fsu
4s07LyYyIoy7JmbS/7XFfKMmgCJyCgqIYqZTo2g+f6Azf77ifDI3H+CyURn8e9paDv+sJoAi8v8p
IIqhEuFh3NW5PqnJcVzZ8hzGp+U0Afxk6XaddhKR/1JAFGPVykUx4oaWfHBvB6qWK8kD7yzlxhcW
sGbHD16XJiIBQAEhXHReJT6+ryP/uqY5G3Yd4oqxs3nsk5V8f+SY16WJiIcUEALkNAG86eJzmZUc
zy3tzuPNBVtISEnj7UXf8quaAIoUSwoI+X8qlo7kb70u4LPBnWlUrRwPf7iCq8fN5atvD3hdmogU
MQWE5CrmnPK8e087xvRpxe5DR7n2uXkkTVrG7kNHvS5NRIqIAkJOyczo1aoWqUnxDIxrwORl2+mW
ks5Lszfxi5oAioQ8vwLCzBLNbJ2ZZZnZQ7nsNzMb69u/3Mxa+zPXzAab2VozW2VmT5394UhhKFMy
god6NGX60C5cVLcS/5iyhh5jZjNng5oAioSyPAPCzMKBcUAPIAboa2YxJw3rATTyfQ0Axuc118wS
gF5AS+dcMyClIA5ICk/9qmV59fY2vNQvlmPZx7nl5YXc++YSth044nVpIlII/HkG0RbIcs5tcs4d
A94h54H9RL2AiS7HAqCimdXMY+69wJPOuZ8BnHO7C+B4pJCZGd1jqvPFsC4kX9qYWet2031kOmNm
qAmgSKjxJyBqAVtP2N7mu8+fMaeb2xjobGYLzSzdzNrk9sPNbICZZZpZ5p49e/woV4pCVIlw7u/a
iJlJ8XRrWp1RM9bTfWQ6X6zaqauxRUKEly9SRwCVgXbAH4BJZmYnD3LOveCci3XOxVatWrWoa5Q8
1KpYinE3t+Y/d11M6chwBryxhNteXczGPT96XZqInCV/AmI7UOeE7dq++/wZc7q524APfaelFgHH
gWj/S5dA0qFhNFOGdOaxnjF8veUAiaMzeGLqGn5UE0CRoOVPQCwGGplZPTOLBPoAk08aMxno53s3
UzvgoHNuRx5zPwYSAMysMRAJ6G0xQaxEeBh3dKrHrD/Ec82FtXg+YxNdU9L46OttOu0kEoTyDAjn
XDZwPzAdWANMcs6tMrOBZjbQN2wqsAnIAl4EBp1urm/OK0B9M1tJzovXtzk9ioSE6LIleap3Sz4a
1IGaFaIY9u4yrp8wn5XbD3pdmojkgwXTY3JsbKzLzMz0ugzJh+PHHe8t2cpT09Zx4Mgxbrr4XJIu
aUKlMpFelyZSbJjZEudcbH7n6UpqKVRhYcaNbc4lNTmefu3r8vairSSMSOPNBVvUBFAkwCkgpEhU
KFWCv1zVjClDOtG0Rjn+/PFKrnp2Dpmb93tdmoicggJCilTTGuV5++52PNP3QvYfPkbvCfMZ9u5S
dv+gJoAigUYBIUXOzLiy5TnMTIrjvoQGTFm+g4SUNJ5P38ixbDUBFAkUCgjxTOnICP5wWVO+GNaF
dvWr8MTna0kck0HGel0xLxIIFBDiubrRZXj59ja8ensbjh939HtlEQMmZrJ1v5oAinhJASEBI6Fp
NaYP68KDiU2YvWEv3UemM/LL9fx0TE0ARbyggJCAUjIinEHxDUlNjuPSZjUYO3MD3UemM23lDl2N
LVLEFBASkGpWKMUzfS/knQHtKBcVwcA3v+LWlxeRtfuQ16WJFBsKCAlo7epX4bPBnfjLlTEs3/Y9
iaNn84/PVnPo6C9elyYS8hQQEvAiwsO4vWM9ZiXH0/ui2rw89xsSUtJ5f8k2jutqbJFCo4CQoFGl
bEmevK4Fn9zXkdqVSpH83jJ6T5jHim1qAihSGBQQEnRa1K7Ih/d24OneLfh2/xGuGjeHhz9cwf7D
x7wuTSSkKCAkKIWFGdfH1iE1OZ47OtZjUuZWElLSmDh/M9m/6mpskYKggJCgVj6qBI/2jOHzBzrT
7JzyPPbJKno+M4dF36gJoMjZUkBISGhcvRxv3XUxz93cmh9++oUbnp/PkLe/ZudBNQEUOVMKCAkZ
ZsblzWsyMymeIV0bMm3VTrqOSGN82kZ+ztbV2CL5pYCQkFMqMpzhlzZhxrA4OjaM5t/T1pI4ejaz
1u32ujSRoKKAkJB1bpXSvNgvltf6t8GA/q8u5q7XF7Nl32GvSxMJCgoICXnxTaoxbWgXHurRlPkb
93HJqAxGfLFOTQBF8qCAkGIhMiKMgXENSE2O5/ILavBMahbdRqQxZbmaAIqcigJCipXq5aMY3edC
Jt3TngqlI7nvP19x04sLWb9LTQBFTqaAkGKpbb3KfDa4E3/v1YzVO36gx5jZ/PXTVRz8SU0ARX6j
gJBiKzzMuLV9XWYlx3Njmzq8Nm8z3UakMWnxVjUBFEEBIULlMpH865rmfHp/J86rUoYHP1jONePn
sWzr916XJuIpBYSIzwW1KvD+wPaMvKEl2w/8xNXPzeWP7y9n748/e12aiCcUECInMDOubV2bWclx
3NWpHh98tY2ElDRenfuNmgBKsaOAEMlFuagS/OmKGKYN7UyrOhX566eruWLsHOZv3Od1aSJFRgEh
choNq5Vj4h1tmXDLRfz4czZ9X1zAff/5iu++/8nr0kQKnQJCJA9mRuIFNZiZFMfQ7o2YsXoX3Uak
M25WlpoASkhTQIj4KapEOEO7N2bG8Di6NI7m6enruHRUBjPX7PK6NJFCoYAQyac6lUvz/K2xvHFn
WyLCjDtfz6T/q4v4Zq+aAEpoUUCInKHOjary+QNd+NPl57N48wEuG5XBU9PWcvjnbK9LEykQCgiR
sxAZEcbdXeqTmhRHz5Y1eS5tI91GpDN52XdqAihBTwEhUgCqlY9i5A2t+ODe9lQpG8mQt7+mzwsL
WLPjB69LEzljCgiRAnTReZWZfH8n/nnNBazbdYgrxs7m8U9WcvCImgBK8PErIMws0czWmVmWmT2U
y34zs7G+/cvNrHU+5iaZmTOz6LM7FJHAEB5m3HzxeaQlx3PzxefxxoItJIxI451F36oJoASVPAPC
zMKBcUAPIAboa2YxJw3rATTyfQ0Axvsz18zqAJcC3571kYgEmIqlI/n71Rfw6eBONKhahoc+XMHV
z83l628PeF2aiF/8eQbRFshyzm1yzh0D3gF6nTSmFzDR5VgAVDSzmn7MHQU8COjPKglZzc6pwKR7
2jOmTyt2HjzKNc/NI/m9Zew5pCaAEtj8CYhawNYTtrf57vNnzCnnmlkvYLtzblk+axYJOmZGr1a1
SE2O5564+nyydDtdU9J4afYmflETQAlQnrxIbWalgUeAx/wYO8DMMs0sc8+ePYVfnEghKlsygod7
nM+0oV1ofV4l/jFlDZePmc28rL1elybyP/wJiO1AnRO2a/vu82fMqe5vANQDlpnZZt/9X5lZjZN/
uHPuBedcrHMutmrVqn6UKxL4GlQty2v92/Biv1iOZv/KTS8tZNBbS9iuJoASQPwJiMVAIzOrZ2aR
QB9g8kljJgP9fO9magccdM7tONVc59wK51w151xd51xdck49tXbO7SyoAxMJdGbGJTHV+XJYHMMv
aUzq2t10G5HG2JkbOPqLmgCK9/IMCOdcNnA/MB1YA0xyzq0ys4FmNtA3bCqwCcgCXgQGnW5ugR+F
SBCLKhHOkG6NmDE8jq5NqzHyy/VcMiqdL1fv0tXY4ikLpl/A2NhYl5mZ6XUZIoVqbtZe/jJ5FRt2
/0hc46o8fmUM9auW9bosCWJmtsQ5F5vfebqSWiTAdGwYzdQHOvNozxi+2nKAy0Zn8MTna/hRTQCl
iCkgRAJQifAw7uxUj9TkeHq1qsXz6ZvompLGx19v12knKTIKCJEAVrVcSVKub8mHgzpQo0IUQ99d
yg3Pz2fVdwe9Lk2KAQWESBBofW4lPh7UkSevbc7GPYe58pk5PPrxSr4/cszr0iSEKSBEgkRYmNGn
7bnMSoqnX/u6vLVwCwkpaby1cAu/qgmgFAIFhEiQqVC6BH+5qhlThnSmUfVy/OmjlfQaN4clW/Z7
XZqEGAWESJA6v2Z53h3QjrF9L2TvoWNcN34+w99dyu4fjnpdmoQIBYRIEDMzrmp5DjOT4hgU34DP
lu+g64h0XszYxLFsNQGUs6OAEAkBZUpG8GBiU6YP60LbepX559Q19BiTwewNanApZ04BIRJC6kWX
4ZXb2/DybbFkH3fc+vIi7nkjk637j3hdmgQhBYRICOp2fnWmD+3CHy5rQsb6vXQfmc6oL9erCaDk
iwJCJERFlQjnvoSGzEyK45KY6oyZuYFuI9KZtnKnrsYWvyggRELcORVL8exNrXn77naULRnBwDeX
0O+VRWTt/tHr0iTAKSBEion2DaowZUgnHr8yhqVbvydxdAb/nLKaQ0d/8bo0CVAKCJFiJCI8jP4d
6zErOZ7rWtfmpTnf0HVEOh8s2cZxXY0tJ1FAiBRD0WVL8u/eLfh4UEfOqViKpPeW0XvCPFZuVxNA
+Z0CQqQYa1mnIh/d24Gnerfg2/1HuPLZOTzy0QoOHFYTQFFAiBR7YWHGDbF1mJkUT/8O9Xh38Vbi
U9J4Y/5mNQEs5hQQIgJAhVIleOzKGKYO6UxMzfI8+skqej4zh8Wb1QSwuFJAiMj/06RGOf5z98WM
u6k1B48c4/oJ8xn6ztfsUhPAYkcBISL/w8y4okVNZiTFMbhrQ6au3EnXlDQmpG9UE8BiRAEhIqdU
OjKCpEub8OWwLrRvUIUnP19L4ugM0tbt9ro0KQIKCBHJ03lVyvDSbW14tX8bHHD7q4u56/VMvt2n
JoChTAEhIn5LaFKNaUM788fEpszbuJfuo9IZ+cU6fjqmJoChSAEhIvlSMiKce+MbkJoUT48LajA2
NYvuI9OZumKHmgCGGAWEiJyRGhWiGNPnQibd055yUREMeusrbn5pIet3HfK6NCkgCggROStt61Xm
s8Gd+FuvZqz67gd6jJnN3z5dzQ9qAhj0FBAictYiwsPo174us5LjuSG2Dq/O+4auKWlMytyqJoBB
TAEhIgWmcplInri2OZPv68S5lUvz4PvLuXb8PJZv+97r0uQMKCBEpMA1r12B9wd2YMT1Ldl24Cd6
jZvLQx8sZ9+PP3tdmuSDAkJECkVYmHHdRbVJTY7jzo71eH/JNhJS0nh93mayf9XV2MFAASEihap8
VAn+3DOGaUM706J2RR6fnNMEcMGmfV6XJnlQQIhIkWhYrRxv3NmWCbe05tDRbPq8sIDBb3/NjoM/
eV2anIICQkSKjJmReEFNZgyPY0i3RkxftZOuKemMm5XFz9m6GjvQKCBEpMiVigxn+CWNmTk8js6N
onl6+jouG5VB6tpdXpcmJ1BAiIhn6lQuzQv9Ypl4R1vCwow7XsvkztcWs3nvYa9LExQQIhIAujSu
yrQHuvDI5U1ZsGkfl47K4OnpazlyLNvr0oo1vwLCzBLNbJ2ZZZnZQ7nsNzMb69u/3Mxa5zXXzJ42
s7W+8R+ZWcWCOSQRCUaREWEM6NKAWcnx9GxRk3GzNtJtRDqfLvtOTQA9kmdAmFk4MA7oAcQAfc0s
5qRhPYBGvq8BwHg/5n4JXOCcawGsBx4+66MRkaBXrXwUI29sxfsD21OpdCSD3/6avi8uYO3OH7wu
rdjx5xlEWyDLObfJOXcMeAfoddKYXsBEl2MBUNHMap5urnPuC+fcb88fFwC1C+B4RCRExNatzKeD
O/GPqy9g7c5DXDF2Dn+ZvIqDP6kJYFHxJyBqAVtP2N7mu8+fMf7MBbgD+Dy3H25mA8ws08wy9+zZ
40e5IhIqwsOMW9qdx6ykePq2rcPE+ZvpmpLGu4u/VRPAIuD5i9Rm9icgG3grt/3OuRecc7HOudiq
VasWbXEiEhAqlYnkH1c3Z/L9nagXXYY/frCCa56by9KtagJYmPwJiO1AnRO2a/vu82fMaeea2e1A
T+Bmp1ehRCQPF9SqwHsD2zP6xlbsOHiUq8fN5Q/vLWPPITUBLAz+BMRioJGZ1TOzSKAPMPmkMZOB
fr53M7UDDjrndpxurpklAg8CVznn9MnnIuIXM+PqC2uRmhzPPV3q8/HS7XRNSeOVOd/wi5oAFqg8
A8L3QvL9wHRgDTDJObfKzAaa2UDfsKnAJiALeBEYdLq5vjnPAuWAL81sqZlNKLjDEpFQV7ZkBA9f
fj7Thnah1bkV+dtnq7li7GzmbdzrdWkhw4LpzE5sbKzLzMz0ugwRCTDOOb5YvYu/f7aabQd+4orm
NXnkivOpVbGU16UFBDNb4pyLze88z1+kFhE5W2bGZc1qMGN4HMO6N2bGml10G5HGMzM3cPQXNQE8
UwoIEQkZUSXCeaB7I2YmxZHQpBojvlzPpaMy+HL1Ll2NfQYUECIScmpXKs34Wy7izTsvJjIijLsn
ZtL/tcVs2vOj16UFFQWEiISsTo2i+fyBzvz5ivPJ3HyAy0Zn8OTnazn8s5oA+kMBISIhrUR4GHd1
rk9qchxXtazFhPSNdB2RxidLt+u0Ux4UECJSLFQrF8WIG1rywb0dqFYuigfeWcqNLyxg9XdqAngq
CggRKVYuOq8SH9/XkSeubc6GXYfo+cxsHvtkJd8fOeZ1aQFHASEixU54mNG37bmkJSdwa7vzeHPB
FhJS0vjPwm/5VU0A/0sBISLFVoXSJfhrrwv4bHBnGlUrxyMfreDqcXNZsuWA16UFBAWEiBR7MeeU
59172jGmTyt2HzrKdePnkTRpGbsPHfW6NE8pIEREyLkau1erWqQmxXNvfAMmL9tO15R0Xpq9qdg2
AVRAiIicoEzJCP6Y2JTpQ7sQW7cS/5iyhh5jZjNnQ/FrAqiAEBHJRf2qZXn19ja81C+WY9nHueXl
hQx8YwnbDhSfTydQQIiInIKZ0T2mOl8M60LypY1JW7+bbiPSGT1jfbFoAqiAEBHJQ1SJcO7v2ojU
pHi6x1Rn9IwNdB+ZzvRVO0P6amwFhIiIn86pWIpxN7XmP3dfTOnIcO55Ywn9XllE1u7QbAKogBAR
yacODaKZMqQzj/WMYenW70kcncG/pq7hxxBrAqiAEBE5AyXCw7ijUz1mJcdzbetavJCxia4paXz0
9baQOe2kgBAROQvRZUvyVO+WfHxfR2pWiGLYu8u4fsJ8Vm4/6HVpZ00BISJSAFrVqchHgzry7+ua
883ew1z57Bz+9NEKDhwO3iaACggRkQISFmbc2OZcUpPjua19Xd5ZvJWEEWm8sWBLUDYBVECIiBSw
CqVK8JermjFlSCea1ijHox+v5Mpn5pC5eb/XpeWLAkJEpJA0rVGet+9ux7M3XciBI8foPWE+w95d
yu4fgqMJoAJCRKQQmRk9W5zDzKQ47k9oyJTlO0hISeP59I0cyw7sJoAKCBGRIlA6MoLky5rwxbAu
tKtfhSc+X0vimAzS1+/xurRTUkCIiBShutFlePn2Nrx6exuOH3fc9soi7p6Yydb9gdcEUAEhIuKB
hKbVmD6sCw8mNmFu1l66jUxn5Jfr+elY4DQBVECIiHikZEQ4g+IbMjMpjsRmNRg7M6cJ4OcrdgTE
1dgKCBERj9WsUIqxfS/knQHtKBcVwb1vfcUtLy9kw65DntalgBARCRDt6lfhs8Gd+OtVzVix7SA9
xszm75+t5oejv3hSjwJCRCSARISHcVuHusxKjuf62Nq8Mvcbuqak8/6SbRwv4quxFRAiIgGoStmS
PHFtCz65ryO1K5Ui+b1lXDdhHiu2FV0TQAWEiEgAa1G7Ih/e24Gne7dg6/4jXDVuDg9/uJz9RdAE
UAEhIhLgwsKM62PrkJoczx0d6zEpcxvxT8/i9Xmbyf618K7GVkCIiASJ8lEleLRnDNMe6Ezz2hV4
fPIqej4zh4Wb9hXKz1NAiIgEmUbVy/HmnRcz/ubWHDqazY0vLGDI21+z82DBNgH0KyDMLNHM1plZ
lpk9lMt+M7Oxvv3Lzax1XnPNrLKZfWlmG3z/ViqYQxIRCX1mRo/mNZkxPI4hXRsybdVOuo5I47m0
LH7OLpjZSMW1AAAFh0lEQVSrsfMMCDMLB8YBPYAYoK+ZxZw0rAfQyPc1ABjvx9yHgJnOuUbATN+2
iIjkQ6nIcIZf2oQZw+Lo2DCap6atI3H0bGat3X3W39ufZxBtgSzn3Cbn3DHgHaDXSWN6ARNdjgVA
RTOrmcfcXsDrvtuvA1ef5bGIiBRb51YpzYv9Ynn9jrYY0P+1xdz52mK27Dt8xt/Tn4CoBWw9YXub
7z5/xpxubnXn3A7f7Z1AdT9rFhGRU4hrXJVpQ7vwcI+mLNi0j0tGZpzx9wqIF6ldTleqXC8RNLMB
ZpZpZpl79gRu33QRkUARGRHGPXENSE2O54oWNc/4+/gTENuBOids1/bd58+Y083d5TsNhe/fXE+Y
OedecM7FOudiq1at6ke5IiICUL18FKNubHXG8/0JiMVAIzOrZ2aRQB9g8kljJgP9fO9magcc9J0+
Ot3cycBtvtu3AZ+c8VGIiEiBi8hrgHMu28zuB6YD4cArzrlVZjbQt38CMBW4HMgCjgD9TzfX962f
BCaZ2Z3AFuCGAj0yERE5KxYIH0rhr9jYWJeZmel1GSIiQcXMljjnYvM7LyBepBYRkcCjgBARkVwp
IEREJFcKCBERyZUCQkREchVU72Iys0PAOq/rCBDRwF6viwgQWovfaS1+p7X4XRPnXLn8TsrzOogA
s+5M3qoViswsU2uRQ2vxO63F77QWvzOzM7o+QKeYREQkVwoIERHJVbAFxAteFxBAtBa/01r8Tmvx
O63F785oLYLqRWoRESk6wfYMQkREikhABoSZJZrZOjPLMrP/+axqX1vxsb79y82stRd1FgU/1uJm
3xqsMLN5ZtbSizoLW17rcMK4NmaWbWa9i7K+ouTPWphZvJktNbNVZpZe1DUWFT/+f1Qws0/NbJlv
Lfp7UWdRMLNXzGy3ma08xf78P2465wLqi5y24BuB+kAksAyIOWnM5cDngAHtgIVe1+3hWnQAKvlu
9wjFtfBnHU4Yl0pO+/neXtft4e9ERWA1cK5vu5rXdXu4Fo8A//bdrgrsByK9rr2Q1qML0BpYeYr9
+X7cDMRnEG2BLOfcJufcMeAdoNdJY3oBE12OBUDF3z6dLsTkuRbOuXnOuQO+zQXkfGpfqPHndwJg
MPABp/h0whDhz1rcBHzonPsWwDkXquvhz1o4oJyZGVCWnIDILtoyi4ZzLoOc4zuVfD9uBmJA1AK2
nrC9zXdffseEgvwe553k/IUQavJcBzOrBVwDjC/Curzgz+9EY6CSmaWZ2RIz61dk1RUtf9biWeB8
4DtgBfCAc+540ZQXcPL9uBlsV1LLKZhZAjkB0cnrWjwyGvijc+54zh+LxVoEcBHQDSgFzDezBc65
9d6W5YnLgKVAV6AB8KWZzXbO/eBtWcEhEANiO1DnhO3avvvyOyYU+HWcZtYCeAno4ZzbV0S1FSV/
1iEWeMcXDtHA5WaW7Zz7uGhKLDL+rMU2YJ9z7jBw2MwygJZAqAWEP2vRH3jS5ZyEzzKzb4CmwKKi
KTGg5PtxMxBPMS0GGplZPTOLBPoAk08aMxno53tVvh1w0Dm3o6gLLQJ5roWZnQt8CNwawn8h5rkO
zrl6zrm6zrm6wPvAoBAMB/Dv/8cnQCczizCz0sDFwJoirrMo+LMW35LzTAozqw40ATYVaZWBI9+P
mwH3DMI5l21m9wPTyXmXwivOuVVmNtC3fwI571K5HMgCjpDzV0LI8XMtHgOqAM/5/nrOdiHWoMzP
dSgW/FkL59waM5sGLAeOAy8553J962Mw8/P34u/Aa2a2gpx37/zROReSHV7N7G0gHog2s23A40AJ
OPPHTV1JLSIiuQrEU0wiIhIAFBAiIpIrBYSIiORKASEiIrlSQIiISK4UECIikisFhIiI5EoBISIi
ufo/JHzsWW0SPIwAAAAASUVORK5CYII=
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">get_contour_data</span><span class="p">(</span><span class="n">xGN</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="o">.</span><span class="mi">002</span><span class="p">)</span>
<span class="n">fig0</span> <span class="o">=</span> <span class="n">contourPlot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">solScat</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">GNDF</span><span class="p">[</span><span class="s1">'phi'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">GNDF</span><span class="p">[</span><span class="s1">'mu'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'yellow'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Next point'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">myObj</span><span class="p">(</span><span class="n">xGN</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myObj</span><span class="p">(</span><span class="n">xArimaSol</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>19.954174587
19.9543522124
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The ballpark estimate brings us three decimal points within the arima result, and yet we shouldn't expect them to be the same. ARIMA estimates the exact liklihood estimation with a Kalman filter, where as our method uses the unconditional liklihood estimation with the backcasting method.</p>
<p>$x^{NG}_{opt} = [\phi = 0.8159, \mu = 19.5000]$</p>
<p>$x^{arima}_{opt} = [\phi = 0.8141, \mu = 19.4998]$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparison-to-Scipy's-minimization-libraries.">Comparison to Scipy's minimization libraries.<a class="anchor-link" href="#Comparison-to-Scipy's-minimization-libraries.">¶</a></h2><p>The scipy library offers a way to compare our Newton Gauss method with BFGS, CG, and a least squares fit algorithm.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compare_scipy_minimization</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Solutions:'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'My Gauss Newton: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myGaussNewton</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">,</span> <span class="n">timeIt</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'CG: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">myObj</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'CG'</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'BFGS: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">myObj</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'BFGS'</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'BFGS with Gradient: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">myObj</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'BFGS'</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">myGrad</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'least squares fit: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">myObj</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">myGrad</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">time_scipy_minimization</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Timeit function outputs for convergence:'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'My Gauss Newton: '</span><span class="p">)</span>
    <span class="o">%</span><span class="k">timeit</span> myGaussNewton(x0, myObj, myGrad, myHess, pGN, timeIt=True)
    <span class="nb">print</span><span class="p">(</span><span class="s1">'CG:'</span><span class="p">)</span>
    <span class="o">%</span><span class="k">timeit</span> opt.minimize(myObj, x0, method='CG').x
    <span class="nb">print</span><span class="p">(</span><span class="s1">'BFGS:'</span><span class="p">)</span>
    <span class="o">%</span><span class="k">timeit</span> opt.minimize(myObj, x0, method='BFGS').x
    <span class="nb">print</span><span class="p">(</span><span class="s1">'BFGS with Gradient:'</span><span class="p">)</span>
    <span class="o">%</span><span class="k">timeit</span> opt.minimize(myObj, x0, method='BFGS', jac=myGrad).x
    <span class="nb">print</span><span class="p">(</span><span class="s1">'least squares fit: '</span><span class="p">)</span>
    <span class="o">%</span><span class="k">timeit</span> opt.least_squares(myObj, x0, jac=myGrad).x
    
<span class="n">compare_scipy_minimization</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">)</span>
<span class="n">time_scipy_minimization</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">pGN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Solutions:
My Gauss Newton: [  0.9645027   19.66902258]
CG: [  0.96450269  19.66963493]
BFGS: [  0.96450271  19.66963035]
BFGS with Gradient: [  0.96449872  19.66958286]
least squares fit: [  0.99891309  24.99816482]

Timeit function outputs for convergence:
My Gauss Newton: 
100 loops, best of 3: 2.62 ms per loop
CG:
10 loops, best of 3: 82.1 ms per loop
BFGS:
10 loops, best of 3: 49.6 ms per loop
BFGS with Gradient:
10 loops, best of 3: 63.4 ms per loop
least squares fit: 
100 loops, best of 3: 13.7 ms per loop
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Scipy's BFGS method with the gradient defined is closest to our Gauss Newton function. If for some reason, the Hessian is singular, the BFGS method can help approximate a solution. Otherwise, our function will get us to a suitable solution quickly.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Minimizing-without-the-gradient.">Minimizing without the gradient.<a class="anchor-link" href="#Minimizing-without-the-gradient.">¶</a></h2><p>Its also possible to minimize without the gradient. For we can approximate the Jacobian numerically.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myJacApprox</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Jacobian</span><span class="p">(</span><span class="n">myFun</span><span class="p">)</span>
<span class="n">myNumGrad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myJacApprox</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">myFun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">myNumHess</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myJacApprox</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">myJacApprox</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">pNumN</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">spla</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">myNumHess</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">myNumGrad</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xGNNum</span><span class="p">,</span> <span class="n">GNDictNum</span> <span class="o">=</span> <span class="n">myGaussNewton</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">myNumGrad</span><span class="p">,</span> <span class="n">myNumHess</span><span class="p">,</span> <span class="n">pNumN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>algorithm has has terminated after 2 steps
fOut: 19.954174579543107
gradNorm: 1.333118926049019e-13
xMin: [  0.81585752  19.49973142]

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GNNumDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">GNDictNum</span><span class="p">)</span>
<span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">get_contour_data</span><span class="p">(</span><span class="n">xGNNum</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="o">.</span><span class="mi">005</span><span class="p">)</span>
<span class="n">fig1</span> <span class="o">=</span> <span class="n">contourPlot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">solScat</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">GNNumDF</span><span class="p">[</span><span class="s1">'phi'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">GNNumDF</span><span class="p">[</span><span class="s1">'mu'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'yellow'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Next point'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AAAAAElFTkSuQmCC
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The numerical approximations terminate after two steps. yet, calculating numerical gradients is costly. Let's compare them with the builtin timeit function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Analitical Jacobian used:'</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> myGaussNewton(x0, myObj, myGrad, myHess, pGN, timeIt=True)
<span class="nb">print</span><span class="p">(</span><span class="s1">'Jacobian approximate used:'</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> myGaussNewton(x0, myObj, myNumGrad, myNumHess, pNumN, timeIt=True)
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Analitical Jacobian used:
100 loops, best of 3: 2.33 ms per loop
Jacobian approximate used:
1 loop, best of 3: 1.32 s per loop
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The numerical approximation slows down the computation time to be about 550 times slower. Clearly it is worth the effort to derive the Jacobian.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Minimizing-an-AR(3).">Minimizing an AR(3).<a class="anchor-link" href="#Minimizing-an-AR(3).">¶</a></h1><p>We saw that an R's arima fit for an AR(3) performed slightly better for Gilbralter climate. Let's compare answers for our Gauss-Newton method.</p>
<p>An AR(3) model has the form:</p>
<p>$$
a_t = Z_t - \mu - \phi_1(Z_{t-1} - \mu) - \phi_2(Z_{t-2} - \mu) - \phi_3(Z_{t-3} - \mu)
$$</p>
<p>The conditional expected value for the shocks is</p>
<p>$$
E(a_t | Z, \mu, \phi_1, \phi_2, \phi_3) = (E(Z_t) - \mu)(1 - \phi_1 - \phi_2 - \phi_3)
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">shock_AR3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">,</span> <span class="n">phi3</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
    <span class="n">shock</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phi1</span> <span class="o">-</span> <span class="n">phi2</span> <span class="o">-</span> <span class="n">phi3</span><span class="p">)</span>
    <span class="n">zdot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">phis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="n">phi3</span><span class="p">,</span> <span class="o">-</span><span class="n">phi2</span><span class="p">,</span> <span class="o">-</span><span class="n">phi1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1">#pdb.set_trace()</span>
    <span class="k">for</span> <span class="n">tdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">zVect</span> <span class="o">=</span> <span class="n">zdot</span><span class="p">[</span><span class="n">tdx</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="n">tdx</span><span class="p">]</span>
        <span class="n">shock</span><span class="p">[</span><span class="n">tdx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">zVect</span><span class="p">,</span> <span class="n">phis</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="c1">#pdb.set_trace()</span>
    <span class="k">return</span> <span class="n">shock</span>

<span class="n">x04</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.10</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">AR4Shocks</span> <span class="o">=</span> <span class="n">shock_AR4</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x04</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x04</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x04</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x04</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">AR4Shocks</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[27]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(401,)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Getting the initial coordinate requres estimating additional weights $\phi_p$ by solving a linear system of equations. See Yule-Walker estimators for further details. Writing out the autocorrelation functions</p>
<p>AR(p) parameters are estimated by</p>
<p>$$
\begin{bmatrix}
    1 & \hat{\rho_{1}} & \hat{\rho_{2}} & \dots  & \hat{\rho_{p-2}} \\
    \hat{\rho_{1}} & 1 & \hat{\rho_{1}} & \dots  & \hat{\rho_{p-3}} \\
    \vdots & \vdots & \vdots & \ddots & \vdots \\
    \hat{\rho_{p-2}} & \hat{\rho_{p-3}} & \hat{\rho_{p-4}} & \dots  & 1
\end{bmatrix}^{-1}
\begin{bmatrix}
\hat{\rho<em>{1}} \
\hat{\rho</em>{2}} \
\dots \
\hat{\rho_{p}}</p>
<h1 id="\end{bmatrix}">\end{bmatrix}<a class="anchor-link" href="#\end{bmatrix}">¶</a></h1><p>\begin{bmatrix}
\hat{\phi_{1}} \\
\hat{\phi_{2}} \\
\dots \\
\hat{\phi_{p}}
\end{bmatrix}
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_inital_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">meanZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="c1"># make vector Z_t - meanZ</span>
    <span class="n">lVect</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">:]</span><span class="o">-</span><span class="n">meanZ</span>
    <span class="c1"># make vector Z_{t-1} - meanZ</span>
    <span class="n">rVect</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">meanZ</span>
    <span class="n">auto_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lVect</span><span class="p">,</span> <span class="n">rVect</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">meanZ</span><span class="p">,</span><span class="n">z</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">meanZ</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">auto_cov</span><span class="p">,</span> <span class="n">meanZ</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">get_ar3_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">get_inital_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rhos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rhos</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_inital_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rhos</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                   <span class="p">[</span><span class="n">rhos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rhos</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                   <span class="p">[</span><span class="n">rhos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rhos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">RTR</span> <span class="o">=</span> <span class="n">spla</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">R</span><span class="p">))</span>
    <span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">,</span> <span class="n">phi3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RTR</span><span class="p">,</span> <span class="n">rhos</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">,</span> <span class="n">phi3</span><span class="p">,</span> <span class="n">mu</span><span class="p">])</span>

<span class="n">x03</span> <span class="o">=</span> <span class="n">get_ar3_estimate</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'inital x0 estimate: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x03</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>inital x0 estimate: [  0.82279846  -0.11763953   0.11818254  19.48976062]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The backcasted AR3 function is written below.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">shock_backcasting_AR3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">,</span> <span class="n">phi3</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">zdot</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">-</span><span class="n">mu</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]</span>
    <span class="n">tb</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">zBack</span> <span class="o">=</span> <span class="n">zdot</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">while</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">zBack</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">zBack</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">>=</span> <span class="o">.</span><span class="mi">005</span><span class="p">):</span>
        <span class="n">zBackStep</span> <span class="o">=</span> <span class="p">[</span> <span class="n">phi1</span> <span class="o">*</span> <span class="n">zBack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                     <span class="o">+</span> <span class="n">phi2</span> <span class="o">*</span> <span class="n">zBack</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                     <span class="o">+</span> <span class="n">phi3</span> <span class="o">*</span> <span class="n">zBack</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">zBack</span> <span class="o">=</span> <span class="n">zBackStep</span> <span class="o">+</span> <span class="n">zBack</span>
        <span class="n">tb</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">M</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">tb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">zdot</span> <span class="o">=</span> <span class="n">zBack</span> <span class="o">+</span> <span class="n">zdot</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
    <span class="n">shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zdot</span><span class="p">))</span>
    <span class="n">zdot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">phis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">phi3</span><span class="p">,</span> <span class="o">-</span><span class="n">phi3</span><span class="p">,</span> <span class="o">-</span><span class="n">phi1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">tdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">zVect</span> <span class="o">=</span> <span class="n">zdot</span><span class="p">[</span><span class="n">tdx</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="n">tdx</span><span class="p">]</span>
        <span class="n">shock</span><span class="p">[</span><span class="n">tdx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">zVect</span><span class="p">,</span> <span class="n">phis</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">zBC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zdot</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shock</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">zBC</span>

<span class="n">bcAR1</span><span class="p">,</span> <span class="n">zBC</span> <span class="o">=</span> <span class="n">shock_backcasting_AR3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x03</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bcAR1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zBC</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>415
401
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Jacobian for an AR(3) Process has five columns.</p>
<p>There are five unknown parameters $\phi_1$, $\phi_2$, $\phi_3$, and $\mu$ thus $J_{ti}(x) \in R^{mx5}$.</p>
<p>$$J_{it}(x) = 
\begin{bmatrix}
    \frac{\partial r_t}{\partial \phi_1},
    \frac{\partial r_t}{\partial \phi_2},
    \frac{\partial r_t}{\partial \phi_3},
    \frac{\partial r_t}{\partial \mu}
\end{bmatrix} = \\
\begin{bmatrix}
    (-Z_{t-1} + \mu),
    (-Z_{t-2} + \mu),
    (-Z_{t-3} + \mu),
    (-1 + \phi_1 + \phi_2 + \phi_3)
\end{bmatrix}
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">Jac_AR3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">,</span> <span class="n">phi3</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">z0</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="n">z1</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">z2</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">z3</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">dPhi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">z1</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="n">dPhi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">z2</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="n">dPhi3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">z3</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="n">dMu</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">phi1</span> <span class="o">+</span> <span class="n">phi2</span> <span class="o">+</span> <span class="n">phi3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z0</span><span class="p">))</span>
    
    <span class="n">Jac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dPhi1</span><span class="p">,</span> <span class="n">dPhi2</span><span class="p">,</span> <span class="n">dPhi3</span><span class="p">,</span> <span class="n">dMu</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    
    <span class="n">Jac</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Jac</span>

<span class="n">Jac0</span> <span class="o">=</span> <span class="n">Jac_AR3</span><span class="p">(</span><span class="n">zBC</span><span class="p">,</span> <span class="n">x03</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">Jac0</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[31]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(397, 4)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We again initialize our AR(3) functions</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_functions</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
    <span class="n">zBC</span> <span class="o">=</span> <span class="n">shock_backcasting_AR3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x03</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x03</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'length of z: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'length of backcasted z: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zBC</span><span class="p">)))</span>
    <span class="n">myFun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">shock_AR3</span><span class="p">(</span><span class="n">zBC</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">myJac</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Jac_AR3</span><span class="p">(</span><span class="n">zBC</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">myGrad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myJac</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">myFun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">myHess</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myJac</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">myJac</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">myObj</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">myFun</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">myFun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">pGN</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">GNP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">myFun</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myJac</span><span class="p">,</span> <span class="n">myHess</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">myFun</span><span class="p">,</span> <span class="n">myJac</span><span class="p">,</span> <span class="n">myGrad</span><span class="p">,</span> <span class="n">myHess</span><span class="p">,</span> <span class="n">myObj</span><span class="p">,</span> <span class="n">pGN</span>


<span class="n">myFun3</span><span class="p">,</span> <span class="n">myJac3</span><span class="p">,</span> <span class="n">myGrad3</span><span class="p">,</span> <span class="n">myHess3</span><span class="p">,</span> <span class="n">myObj3</span><span class="p">,</span> <span class="n">pGN3</span> <span class="o">=</span> <span class="n">init_functions</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span>
<span class="n">fun0</span> <span class="o">=</span> <span class="n">myFun3</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span>
<span class="n">J0</span> <span class="o">=</span> <span class="n">myJac4</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span>
<span class="n">F0</span> <span class="o">=</span> <span class="n">myObj4</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span>
<span class="n">g0</span> <span class="o">=</span> <span class="n">myGrad4</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span>
<span class="n">H0</span> <span class="o">=</span> <span class="n">myHess4</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">pGN4</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>length of z: 401
length of backcasted z: 401
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">F0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fun0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>18.7004435656
(397,)
(397, 4)
(4,)
(4, 4)
(4,)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Approximating-the-Jacobian">Approximating the Jacobian<a class="anchor-link" href="#Approximating-the-Jacobian">¶</a></h2><p>Again, we should check if our analitical jacobian agrees with the numerical.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">JacApprox3</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Jacobian</span><span class="p">(</span><span class="n">myFun3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">JacApprox3</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[40]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(397, 4)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">myJac3</span><span class="p">(</span><span class="n">x03</span><span class="p">)</span> <span class="o">-</span> <span class="n">JacApprox3</span><span class="p">(</span><span class="n">x03</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[41]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.30598450635147173</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There shouldn't be anything left over...The numerical jacobian is is approximating -0.0004475. We shall soon see that this does not affect the optimal value when we compare scipy's BFGS method without providing the gradient.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">JacApprox3</span><span class="p">(</span><span class="n">x03</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[43]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([[ -4.47543376e-04,  -4.47543376e-04,  -4.47543376e-04,
         -1.76658536e-01],
       [ -4.47543376e-04,  -4.47543376e-04,  -4.47543376e-04,
         -1.76658536e-01],
       [ -4.47543376e-04,  -4.47543376e-04,  -4.47543376e-04,
         -1.76658536e-01],
       [ -6.92526767e-01,  -6.34118990e-01,   2.62100811e-01,
         -1.76658536e-01],
       [ -1.19638393e-01,  -6.92526767e-01,  -6.34118990e-01,
         -1.76658536e-01]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myJac3</span><span class="p">(</span><span class="n">x03</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[44]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([[ 0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ],
       [-0.69252677, -0.63411899,  0.26210081, -0.17665854],
       [-0.11963839, -0.69252677, -0.63411899, -0.17665854]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AR(3)-Model-performance">AR(3) Model performance<a class="anchor-link" href="#AR(3)-Model-performance">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xGN3</span><span class="p">,</span> <span class="n">GN3Dict</span> <span class="o">=</span> <span class="n">myGaussNewton</span><span class="p">(</span><span class="n">x03</span><span class="p">,</span> <span class="n">myObj3</span><span class="p">,</span> <span class="n">myGrad3</span><span class="p">,</span> <span class="n">myHess3</span><span class="p">,</span> <span class="n">pGN3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>algorithm has has terminated after 2 steps
fOut: 18.670361350895927
gradNorm: 1.3439775923736026e-14
xMin: [  0.85991845  -0.15030482   0.12875629  19.49622801]

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here the the solution terminates after 8 steps. There is a slight difference within the arima function and our Gauss Newton method.</p>
<p>$$
x^{arima}_{opt} = [0.8340 \pm 0.0497,\ -0.1145 \pm 0.0646 ,\ 0.1152 \pm 0.0499,\ 19.5094 \pm 0.0949]
$$</p>
<p>It is important to consider that R includes a 95% confidence interval to the estimated parameters.</p>
<p>$$
x_{opt}^{GN} = [\phi_1 = 0.8599 ,\ \phi_2 =  -0.1503,\ \phi_3 = 0.1288,\ \mu = 19.4962 ]
$$</p>
<p>The presence of a confidence interval verifies our Gauss-Newton method because its solution $x^{arima}_{opt}$ falls within this confidence interval.</p>
<p>The objective function as defined in this notebook sides with Gauss-Newton over the arima results.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x3arima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8340</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1145</span><span class="p">,</span> <span class="mf">0.1152</span><span class="p">,</span> <span class="mf">19.5094</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myObj3</span><span class="p">(</span><span class="n">xGN3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myObj3</span><span class="p">(</span><span class="n">x3arima</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>18.6703613509
18.6877692217
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GNDF3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">GN3Dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GNDF3</span><span class="p">[</span><span class="s1">'F'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[51]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.axes._subplots.axessubplot at 0x7fdfe802efd0></pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
RU5ErkJggg==
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GNDF3</span><span class="p">[</span><span class="s1">'normGrad'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[53]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.axes._subplots.axessubplot at 0x7fdfe7fa5b70></pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
6AV8ysuapz8AAAAASUVORK5CYII=
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparison-to-Scipy's-minimization-libraries.">Comparison to Scipy's minimization libraries.<a class="anchor-link" href="#Comparison-to-Scipy's-minimization-libraries.">¶</a></h2><p>Using scipy's BFGS minimization without including the Jacobian brings the returns a solution that is comparable to arima's solution, yet uneasily off.</p>
<p>$$
x^{arima}_{opt} = [0.8340 \pm 0.0497,\ -0.1145 \pm 0.0646 ,\ 0.1152 \pm 0.0499,\ 19.5094 \pm 0.0949]
$$</p>
<p>Scipy's comparison functions side with Gauss-Newton</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">compare_scipy_minimization</span><span class="p">(</span><span class="n">x03</span><span class="p">,</span> <span class="n">myObj3</span><span class="p">,</span> <span class="n">myGrad3</span><span class="p">,</span> <span class="n">myHess3</span><span class="p">,</span> <span class="n">pGN3</span><span class="p">)</span>
<span class="n">time_scipy_minimization</span><span class="p">(</span><span class="n">x03</span><span class="p">,</span> <span class="n">myObj3</span><span class="p">,</span> <span class="n">myGrad3</span><span class="p">,</span> <span class="n">myHess3</span><span class="p">,</span> <span class="n">pGN3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Solutions:
My Gauss Newton: [  0.85991845  -0.15030482   0.12875629  19.49622801]
CG: [  0.85991855  -0.15030493   0.12875613  19.49618251]
BFGS: [  0.85991843  -0.15030475   0.12875606  19.49618247]
BFGS with Gradient: [  0.85991843  -0.15030481   0.1287563   19.49622799]
least squares fit: [  0.85982442  -0.15015244   0.12866277  19.4960783 ]

Timeit function outputs for convergence:
My Gauss Newton: 
100 loops, best of 3: 2.52 ms per loop
CG:
10 loops, best of 3: 81.9 ms per loop
BFGS:
10 loops, best of 3: 50.6 ms per loop
BFGS with Gradient:
10 loops, best of 3: 66.3 ms per loop
least squares fit: 
100 loops, best of 3: 13.9 ms per loop
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note the additional model complexity does not affect the time very much.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h1><p>I find it remarkable that we don't have to depend on constrained optimization algorithms. The model is motivated naturally to settle down on a solution that is stable, provided the inital starting point is agreeable.</p>
<p>The method of moments, although makes a low quality estimator, drives the more refined estimators on track.</p>
<p>It is disconcerting that all of the models solved in python disagree with R's arima function best fit, but we must rember that arima uses a maximum liklihood method using a Kalman filter.</p>
<p>Its amazing how much the arima() function does. As we near the end of this notebook, we may recall the efforts it took to find a specific solution. Although our model is the fastest in this context, I have a much deeper appreciation for the libraries provided by scipy and R. I am in awe of the mechanics behind these functions, and their, robustness, and their ability for generalization.</p>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">
        Tyler Tucker
    </span>
  </span>
<time datetime="2017-12-28T23:00:00-08:00" pubdate>Thu 28 December 2017</time>  <span class="categories">
    <a class='category' href='./category/argo.html'>ARGO</a>
  </span>
  <span class="categories">
    <a class="category" href="./tag/python.html">python</a>,    <a class="category" href="./tag/climate.html">climate</a>,    <a class="category" href="./tag/timeseries.html">timeseries</a>,    <a class="category" href="./tag/optimization.html">optimization</a>  </span>
</p><div class="sharing">
</div>    </footer>
  </article>

</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="./langley-extrapolation.html">Langley Extrapolation</a>
      </li>
      <li class="post">
          <a href="./argovis-tutorials.html">Argovis Tutorials</a>
      </li>
      <li class="post">
          <a href="./ns-eq-cg.html">Ocean Modeling with Fortran</a>
      </li>
      <li class="post">
          <a href="./Baysean-Predict-Post.html">Bayesian Predictive Posterior for Normal Distribution using SIR prior</a>
      </li>
      <li class="post">
          <a href="./Taylor-Series.html">Taylor Series</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="./category/about.html">about</a></li>
        <li><a href="./category/argo.html">ARGO</a></li>
        <li><a href="./category/ims.html">IMS</a></li>
        <li><a href="./category/math.html">Math</a></li>
        <li><a href="./category/python.html">Python</a></li>
        <li><a href="./category/statistics.html">Statistics</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="./tag/calculus.html">calculus</a>,    <a href="./tag/climate.html">climate</a>,    <a href="./tag/statistics.html">statistics</a>,    <a href="./tag/probability.html">Probability</a>,    <a href="./tag/python.html">python</a>,    <a href="./tag/baysean.html">Baysean</a>,    <a href="./tag/taylor-series.html">taylor series</a>,    <a href="./tag/ocean-modeling.html">ocean modeling</a>,    <a href="./tag/map-projections.html">map projections</a>,    <a href="./tag/fortran.html">fortran</a>,    <a href="./tag/api.html">api</a>,    <a href="./tag/timeseries.html">timeseries</a>,    <a href="./tag/argovis.html">argovis</a>,    <a href="./tag/sympy.html">sympy</a>,    <a href="./tag/optimization.html">optimization</a>  </section>


    <section>
        <h1>Social</h1>
        <ul>
            <li><a href="http://kargaaad.blogspot.com/" target="_blank">In my past life, I taught English in the Republic of Georgia</a></li>
            <li><a href="https://sites.google.com/a/eng.ucsd.edu/156b-2012-winter-team17/" target="_blank">My senior project that im still proud of</a></li>
        </ul>
    </section>
    <section>
        <h1>Blogroll</h1>
        <ul>
            <li><a href="http://shen.sdsu.edu/research_group.html" target="_blank">My research group</a></li>
        </ul>
    </section>

</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2017&ndash;2018  tyler tucker &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script src="./theme/js/modernizr-2.0.js"></script>
  <script src="./theme/js/ender.js"></script>
  <script src="./theme/js/octopress.js" type="text/javascript"></script>
</body>
</html>